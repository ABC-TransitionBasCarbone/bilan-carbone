enum Import {
  BaseEmpreinte
  Manual
}

enum EmissionStatus {
  Archived
  Valid
}

model Emission {
  id            String         @id @default(uuid())
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @default(now()) @map("updated_at")
  emissionPosts EmissionPost[]

  importedFrom   Import        @map("imported_from")
  importedId     String?       @map("imported_id")
  organizationId String?       @map("organization_id")
  organization   Organization? @relation(fields: [organizationId], references: [id])

  status   EmissionStatus
  metaData EmissionMetaData[]
  source   String?
  location String?

  incertitude Int?

  reliability                  Int
  technicalRepresentativeness  Float? @map("technical_representativeness")
  geographicRepresentativeness Float? @map("geographic_representativeness")
  temporalRepresentativeness   Float? @map("temporal_representativeness")
  completeness                 Float? @map("completeness")

  totalCo2 Float  @map("total_co2")
  co2f     Float?
  ch4f     Float?
  ch4b     Float?
  n2o      Float?
  co2b     Float?
  sf6      Float?
  hfc      Float?
  pfc      Float?
  otherGES Float? @map("other_ges")
  unit     Unit?

  @@index([organizationId])
  @@index([status])
  @@map("emissions")
}

model EmissionMetaData {
  emission   Emission @relation(fields: [emissionId], references: [id])
  emissionId String   @map("emission_id")
  language   String

  title     String?
  attribute String?
  frontiere String?
  tag       String?
  location  String?
  comment   String?

  @@id([emissionId, language])
  @@map("emission_metadata")
}

model EmissionPost {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  emissionId String                 @map("emission_id")
  emission   Emission               @relation(fields: [emissionId], references: [id])
  metaData   EmissionPostMetaData[]
  type       PostType

  totalCo2 Float  @map("total_co2")
  co2f     Float?
  ch4f     Float?
  ch4b     Float?
  n2o      Float?
  co2b     Float?
  sf6      Float?
  hfc      Float?
  pfc      Float?
  otherGES Float? @map("other_ges")

  @@map("emission_posts")
}

model EmissionPostMetaData {
  emissionPost   EmissionPost @relation(fields: [emissionPostId], references: [id])
  emissionPostId String       @map("emission_post_id")
  title          String
  language       String

  @@id([emissionPostId, language])
  @@map("emission_post_metadata")
}
